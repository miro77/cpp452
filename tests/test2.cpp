#include <gtest/gtest.h>  // googletest header file

#include "../include/P452.hpp"

TEST(P452, Test2) {
  double press = 1013.000000;
  double DN = 53.000000;
  double temp = 15.000000;
  double phi_path = 50.965000;
  double Gt = 20.000000;
  double Gr = 5.000000;
  double N0 = 328.000000;
  int pol = 2;
  double dct = 500.000000;
  double dcr = 500.000000;
  double htg = 10.000000;
  double hrg = 10.000000;
  double ha_t = 0.000000;
  double dk_t = 0.000000;
  double ha_r = 0.000000;
  double dk_r = 0.000000;
  double rDist[101];
  double rHeight[101];
  int iZone[101];
  // double phi_r = 50.965000;
  double ff[35];
  double pp[35];
  rDist[0] = 0.000000;
  rDist[1] = 1.000000;
  rDist[2] = 2.000000;
  rDist[3] = 3.000000;
  rDist[4] = 4.000000;
  rDist[5] = 5.000000;
  rDist[6] = 6.000000;
  rDist[7] = 7.000000;
  rDist[8] = 8.000000;
  rDist[9] = 9.000000;
  rDist[10] = 10.000000;
  rDist[11] = 11.000000;
  rDist[12] = 12.000000;
  rDist[13] = 13.000000;
  rDist[14] = 14.000000;
  rDist[15] = 15.000000;
  rDist[16] = 16.000000;
  rDist[17] = 17.000000;
  rDist[18] = 18.000000;
  rDist[19] = 19.000000;
  rDist[20] = 20.000000;
  rDist[21] = 21.000000;
  rDist[22] = 22.000000;
  rDist[23] = 23.000000;
  rDist[24] = 24.000000;
  rDist[25] = 25.000000;
  rDist[26] = 26.000000;
  rDist[27] = 27.000000;
  rDist[28] = 28.000000;
  rDist[29] = 29.000000;
  rDist[30] = 30.000000;
  rDist[31] = 31.000000;
  rDist[32] = 32.000000;
  rDist[33] = 33.000000;
  rDist[34] = 34.000000;
  rDist[35] = 35.000000;
  rDist[36] = 36.000000;
  rDist[37] = 37.000000;
  rDist[38] = 38.000000;
  rDist[39] = 39.000000;
  rDist[40] = 40.000000;
  rDist[41] = 41.000000;
  rDist[42] = 42.000000;
  rDist[43] = 43.000000;
  rDist[44] = 44.000000;
  rDist[45] = 45.000000;
  rDist[46] = 46.000000;
  rDist[47] = 47.000000;
  rDist[48] = 48.000000;
  rDist[49] = 49.000000;
  rDist[50] = 50.000000;
  rDist[51] = 51.000000;
  rDist[52] = 52.000000;
  rDist[53] = 53.000000;
  rDist[54] = 54.000000;
  rDist[55] = 55.000000;
  rDist[56] = 56.000000;
  rDist[57] = 57.000000;
  rDist[58] = 58.000000;
  rDist[59] = 59.000000;
  rDist[60] = 60.000000;
  rDist[61] = 61.000000;
  rDist[62] = 62.000000;
  rDist[63] = 63.000000;
  rDist[64] = 64.000000;
  rDist[65] = 65.000000;
  rDist[66] = 66.000000;
  rDist[67] = 67.000000;
  rDist[68] = 68.000000;
  rDist[69] = 69.000000;
  rDist[70] = 70.000000;
  rDist[71] = 71.000000;
  rDist[72] = 72.000000;
  rDist[73] = 73.000000;
  rDist[74] = 74.000000;
  rDist[75] = 75.000000;
  rDist[76] = 76.000000;
  rDist[77] = 77.000000;
  rDist[78] = 78.000000;
  rDist[79] = 79.000000;
  rDist[80] = 80.000000;
  rDist[81] = 81.000000;
  rDist[82] = 82.000000;
  rDist[83] = 83.000000;
  rDist[84] = 84.000000;
  rDist[85] = 85.000000;
  rDist[86] = 86.000000;
  rDist[87] = 87.000000;
  rDist[88] = 88.000000;
  rDist[89] = 89.000000;
  rDist[90] = 90.000000;
  rDist[91] = 91.000000;
  rDist[92] = 92.000000;
  rDist[93] = 93.000000;
  rDist[94] = 94.000000;
  rDist[95] = 95.000000;
  rDist[96] = 96.000000;
  rDist[97] = 97.000000;
  rDist[98] = 98.000000;
  rDist[99] = 99.000000;
  rDist[100] = 100.000000;
  rHeight[0] = 0.000000;
  rHeight[1] = 0.000000;
  rHeight[2] = 0.000000;
  rHeight[3] = 0.000000;
  rHeight[4] = 0.000000;
  rHeight[5] = 0.000000;
  rHeight[6] = 0.000000;
  rHeight[7] = 0.000000;
  rHeight[8] = 0.000000;
  rHeight[9] = 0.000000;
  rHeight[10] = 0.000000;
  rHeight[11] = 0.000000;
  rHeight[12] = 0.000000;
  rHeight[13] = 0.000000;
  rHeight[14] = 0.000000;
  rHeight[15] = 0.000000;
  rHeight[16] = 0.000000;
  rHeight[17] = 0.000000;
  rHeight[18] = 0.000000;
  rHeight[19] = 0.000000;
  rHeight[20] = 0.000000;
  rHeight[21] = 0.000000;
  rHeight[22] = 0.000000;
  rHeight[23] = 0.000000;
  rHeight[24] = 0.000000;
  rHeight[25] = 0.000000;
  rHeight[26] = 0.000000;
  rHeight[27] = 0.000000;
  rHeight[28] = 0.000000;
  rHeight[29] = 0.000000;
  rHeight[30] = 0.000000;
  rHeight[31] = 0.000000;
  rHeight[32] = 0.000000;
  rHeight[33] = 0.000000;
  rHeight[34] = 0.000000;
  rHeight[35] = 0.000000;
  rHeight[36] = 0.000000;
  rHeight[37] = 0.000000;
  rHeight[38] = 0.000000;
  rHeight[39] = 0.000000;
  rHeight[40] = 0.000000;
  rHeight[41] = 0.000000;
  rHeight[42] = 0.000000;
  rHeight[43] = 0.000000;
  rHeight[44] = 0.000000;
  rHeight[45] = 0.000000;
  rHeight[46] = 0.000000;
  rHeight[47] = 0.000000;
  rHeight[48] = 0.000000;
  rHeight[49] = 0.000000;
  rHeight[50] = 0.000000;
  rHeight[51] = 0.000000;
  rHeight[52] = 0.000000;
  rHeight[53] = 0.000000;
  rHeight[54] = 0.000000;
  rHeight[55] = 0.000000;
  rHeight[56] = 0.000000;
  rHeight[57] = 0.000000;
  rHeight[58] = 0.000000;
  rHeight[59] = 0.000000;
  rHeight[60] = 0.000000;
  rHeight[61] = 0.000000;
  rHeight[62] = 0.000000;
  rHeight[63] = 0.000000;
  rHeight[64] = 0.000000;
  rHeight[65] = 0.000000;
  rHeight[66] = 0.000000;
  rHeight[67] = 0.000000;
  rHeight[68] = 0.000000;
  rHeight[69] = 0.000000;
  rHeight[70] = 0.000000;
  rHeight[71] = 0.000000;
  rHeight[72] = 0.000000;
  rHeight[73] = 0.000000;
  rHeight[74] = 0.000000;
  rHeight[75] = 0.000000;
  rHeight[76] = 0.000000;
  rHeight[77] = 0.000000;
  rHeight[78] = 0.000000;
  rHeight[79] = 0.000000;
  rHeight[80] = 0.000000;
  rHeight[81] = 0.000000;
  rHeight[82] = 0.000000;
  rHeight[83] = 0.000000;
  rHeight[84] = 0.000000;
  rHeight[85] = 0.000000;
  rHeight[86] = 0.000000;
  rHeight[87] = 0.000000;
  rHeight[88] = 0.000000;
  rHeight[89] = 0.000000;
  rHeight[90] = 0.000000;
  rHeight[91] = 0.000000;
  rHeight[92] = 0.000000;
  rHeight[93] = 0.000000;
  rHeight[94] = 0.000000;
  rHeight[95] = 0.000000;
  rHeight[96] = 0.000000;
  rHeight[97] = 0.000000;
  rHeight[98] = 0.000000;
  rHeight[99] = 0.000000;
  rHeight[100] = 0.000000;
  iZone[0] = 2;
  iZone[1] = 2;
  iZone[2] = 2;
  iZone[3] = 2;
  iZone[4] = 2;
  iZone[5] = 2;
  iZone[6] = 2;
  iZone[7] = 2;
  iZone[8] = 2;
  iZone[9] = 2;
  iZone[10] = 2;
  iZone[11] = 2;
  iZone[12] = 2;
  iZone[13] = 2;
  iZone[14] = 2;
  iZone[15] = 2;
  iZone[16] = 2;
  iZone[17] = 2;
  iZone[18] = 2;
  iZone[19] = 2;
  iZone[20] = 2;
  iZone[21] = 2;
  iZone[22] = 2;
  iZone[23] = 2;
  iZone[24] = 2;
  iZone[25] = 2;
  iZone[26] = 2;
  iZone[27] = 2;
  iZone[28] = 2;
  iZone[29] = 2;
  iZone[30] = 2;
  iZone[31] = 2;
  iZone[32] = 2;
  iZone[33] = 2;
  iZone[34] = 2;
  iZone[35] = 2;
  iZone[36] = 2;
  iZone[37] = 2;
  iZone[38] = 2;
  iZone[39] = 2;
  iZone[40] = 2;
  iZone[41] = 2;
  iZone[42] = 2;
  iZone[43] = 2;
  iZone[44] = 2;
  iZone[45] = 2;
  iZone[46] = 2;
  iZone[47] = 2;
  iZone[48] = 2;
  iZone[49] = 2;
  iZone[50] = 2;
  iZone[51] = 2;
  iZone[52] = 2;
  iZone[53] = 2;
  iZone[54] = 2;
  iZone[55] = 2;
  iZone[56] = 2;
  iZone[57] = 2;
  iZone[58] = 2;
  iZone[59] = 2;
  iZone[60] = 2;
  iZone[61] = 2;
  iZone[62] = 2;
  iZone[63] = 2;
  iZone[64] = 2;
  iZone[65] = 2;
  iZone[66] = 2;
  iZone[67] = 2;
  iZone[68] = 2;
  iZone[69] = 2;
  iZone[70] = 2;
  iZone[71] = 2;
  iZone[72] = 2;
  iZone[73] = 2;
  iZone[74] = 2;
  iZone[75] = 2;
  iZone[76] = 2;
  iZone[77] = 2;
  iZone[78] = 2;
  iZone[79] = 2;
  iZone[80] = 2;
  iZone[81] = 2;
  iZone[82] = 2;
  iZone[83] = 2;
  iZone[84] = 2;
  iZone[85] = 2;
  iZone[86] = 2;
  iZone[87] = 2;
  iZone[88] = 2;
  iZone[89] = 2;
  iZone[90] = 2;
  iZone[91] = 2;
  iZone[92] = 2;
  iZone[93] = 2;
  iZone[94] = 2;
  iZone[95] = 2;
  iZone[96] = 2;
  iZone[97] = 2;
  iZone[98] = 2;
  iZone[99] = 2;
  iZone[100] = 2;
  ff[0] = 2.0000000000000000;
  ff[1] = 0.1000000000000000;
  ff[2] = 0.1500000000000000;
  ff[3] = 0.2250000000000000;
  ff[4] = 0.3375000000000000;
  ff[5] = 0.5062500000000000;
  ff[6] = 0.7593750000000000;
  ff[7] = 1.1390625000000001;
  ff[8] = 1.7085937499999999;
  ff[9] = 2.5628906250000001;
  ff[10] = 3.8443359380000000;
  ff[11] = 5.7665039059999996;
  ff[12] = 8.6497558590000008;
  ff[13] = 12.9746337900000004;
  ff[14] = 19.4619506800000011;
  ff[15] = 29.1929260299999989;
  ff[16] = 43.7893890400000032;
  ff[17] = 50.0000000000000000;
  ff[18] = 2.0000000000000000;
  ff[19] = 2.0000000000000000;
  ff[20] = 2.0000000000000000;
  ff[21] = 2.0000000000000000;
  ff[22] = 2.0000000000000000;
  ff[23] = 2.0000000000000000;
  ff[24] = 2.0000000000000000;
  ff[25] = 2.0000000000000000;
  ff[26] = 2.0000000000000000;
  ff[27] = 2.0000000000000000;
  ff[28] = 2.0000000000000000;
  ff[29] = 2.0000000000000000;
  ff[30] = 2.0000000000000000;
  ff[31] = 2.0000000000000000;
  ff[32] = 2.0000000000000000;
  ff[33] = 2.0000000000000000;
  ff[34] = 2.0000000000000000;
  pp[0] = 49.0000000000000000;
  pp[1] = 49.0000000000000000;
  pp[2] = 49.0000000000000000;
  pp[3] = 49.0000000000000000;
  pp[4] = 49.0000000000000000;
  pp[5] = 49.0000000000000000;
  pp[6] = 49.0000000000000000;
  pp[7] = 49.0000000000000000;
  pp[8] = 49.0000000000000000;
  pp[9] = 49.0000000000000000;
  pp[10] = 49.0000000000000000;
  pp[11] = 49.0000000000000000;
  pp[12] = 49.0000000000000000;
  pp[13] = 49.0000000000000000;
  pp[14] = 49.0000000000000000;
  pp[15] = 49.0000000000000000;
  pp[16] = 49.0000000000000000;
  pp[17] = 49.0000000000000000;
  pp[18] = 1.0000000000000000;
  pp[19] = 4.0000000000000000;
  pp[20] = 7.0000000000000000;
  pp[21] = 10.0000000000000000;
  pp[22] = 13.0000000000000000;
  pp[23] = 16.0000000000000000;
  pp[24] = 19.0000000000000000;
  pp[25] = 22.0000000000000000;
  pp[26] = 25.0000000000000000;
  pp[27] = 28.0000000000000000;
  pp[28] = 31.0000000000000000;
  pp[29] = 34.0000000000000000;
  pp[30] = 37.0000000000000000;
  pp[31] = 40.0000000000000000;
  pp[32] = 43.0000000000000000;
  pp[33] = 46.0000000000000000;
  pp[34] = 49.0000000000000000;
  // Results obtained from the MATLAB implementation of ITU-R P.452-17
  // available on the ITU-R SG3 sharefolder
  double expectedResult[35];
  expectedResult[0] = 193.1410292788861227;
  expectedResult[1] = 155.7284000936704160;
  expectedResult[2] = 161.2224065709905574;
  expectedResult[3] = 166.5857113717042921;
  expectedResult[4] = 171.8327495241859424;
  expectedResult[5] = 176.9667426989809087;
  expectedResult[6] = 181.9617473894253976;
  expectedResult[7] = 186.7775220966599932;
  expectedResult[8] = 191.3975214229607502;
  expectedResult[9] = 195.8330798168793194;
  expectedResult[10] = 200.1059294461138620;
  expectedResult[11] = 204.2440139581638050;
  expectedResult[12] = 208.3000533358982125;
  expectedResult[13] = 212.4517120963314483;
  expectedResult[14] = 218.9792995799146240;
  expectedResult[15] = 223.0295600298136378;
  expectedResult[16] = 233.0146253584027534;
  expectedResult[17] = 254.0259630407253155;
  expectedResult[18] = 152.4433215358951372;
  expectedResult[19] = 169.3196367408342269;
  expectedResult[20] = 178.9984917184318647;
  expectedResult[21] = 184.6055057621471747;
  expectedResult[22] = 186.4562680032719868;
  expectedResult[23] = 187.3221915399690829;
  expectedResult[24] = 188.0010454970459648;
  expectedResult[25] = 188.6007422702394933;
  expectedResult[26] = 189.1492581411956166;
  expectedResult[27] = 189.6613417382024522;
  expectedResult[28] = 190.1475203474755631;
  expectedResult[29] = 190.6164870777134297;
  expectedResult[30] = 191.0764437426452389;
  expectedResult[31] = 191.5365159179539205;
  expectedResult[32] = 192.0092966531956904;
  expectedResult[33] = 192.5182007056459383;
  expectedResult[34] = 193.1410292788861227;
  vector<double> rDisti;
  rDisti.reserve(101);
  vector<double> rHighti;
  rHighti.reserve(101);
  vector<int> iZonei;
  iZonei.reserve(101);
  for (int i = 0; i < 101; i++) {
    rDisti.push_back(rDist[i]);
    rHighti.push_back(rHeight[i]);
    iZonei.push_back(iZone[i]);
  }
  for (int ii = 0; ii < 35; ii++) {
    double result =
        tl_p452(ff[ii], pp[ii], rDisti, rHighti, iZonei, htg, hrg, phi_path, Gt,
                Gr, pol, dct, dcr, DN, N0, press, temp, ha_t, ha_r, dk_t, dk_r);
    EXPECT_DOUBLE_EQ(expectedResult[ii], result);
  }
}
