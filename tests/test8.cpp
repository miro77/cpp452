#include <gtest/gtest.h>  // googletest header file
#include "../include/P452.hpp"

TEST(P452, Test8) {
  double press = 1013.000000;
  double DN = 53.000000;
  double temp = 15.000000;
  double phi_path = 50.965000;
  double Gt = 20.000000;
  double Gr = 5.000000;
  double N0 = 328.000000;
  int pol = 1;
  double dct = 500.000000;
  double dcr = 500.000000;
  double htg = 10.000000;
  double hrg = 10.000000;
  double ha_t = 0.000000;
  double dk_t = 0.000000;
  double ha_r = 0.000000;
  double dk_r = 0.000000;
  double rDist[110];
  double rHeight[110];
  int iZone[110];
  // double phi_r = 50.965000;
  double ff[35];
  double pp[35];
  rDist[0] = 0.000000;
  rDist[1] = 1.000000;
  rDist[2] = 2.000000;
  rDist[3] = 3.000000;
  rDist[4] = 4.000000;
  rDist[5] = 5.000000;
  rDist[6] = 6.000000;
  rDist[7] = 7.000000;
  rDist[8] = 8.000000;
  rDist[9] = 9.000000;
  rDist[10] = 10.000000;
  rDist[11] = 11.000000;
  rDist[12] = 12.000000;
  rDist[13] = 13.000000;
  rDist[14] = 14.000000;
  rDist[15] = 15.000000;
  rDist[16] = 16.000000;
  rDist[17] = 17.000000;
  rDist[18] = 18.000000;
  rDist[19] = 19.000000;
  rDist[20] = 20.000000;
  rDist[21] = 21.000000;
  rDist[22] = 22.000000;
  rDist[23] = 23.000000;
  rDist[24] = 24.000000;
  rDist[25] = 25.000000;
  rDist[26] = 26.000000;
  rDist[27] = 27.000000;
  rDist[28] = 28.000000;
  rDist[29] = 29.000000;
  rDist[30] = 30.000000;
  rDist[31] = 31.000000;
  rDist[32] = 32.000000;
  rDist[33] = 33.000000;
  rDist[34] = 34.000000;
  rDist[35] = 35.000000;
  rDist[36] = 36.000000;
  rDist[37] = 37.000000;
  rDist[38] = 38.000000;
  rDist[39] = 39.000000;
  rDist[40] = 40.000000;
  rDist[41] = 41.000000;
  rDist[42] = 42.000000;
  rDist[43] = 43.000000;
  rDist[44] = 44.000000;
  rDist[45] = 45.000000;
  rDist[46] = 46.000000;
  rDist[47] = 47.000000;
  rDist[48] = 48.000000;
  rDist[49] = 49.000000;
  rDist[50] = 50.000000;
  rDist[51] = 51.000000;
  rDist[52] = 52.000000;
  rDist[53] = 53.000000;
  rDist[54] = 54.000000;
  rDist[55] = 55.000000;
  rDist[56] = 56.000000;
  rDist[57] = 57.000000;
  rDist[58] = 58.000000;
  rDist[59] = 59.000000;
  rDist[60] = 60.000000;
  rDist[61] = 61.000000;
  rDist[62] = 62.000000;
  rDist[63] = 63.000000;
  rDist[64] = 64.000000;
  rDist[65] = 65.000000;
  rDist[66] = 66.000000;
  rDist[67] = 67.000000;
  rDist[68] = 68.000000;
  rDist[69] = 69.000000;
  rDist[70] = 70.000000;
  rDist[71] = 71.000000;
  rDist[72] = 72.000000;
  rDist[73] = 73.000000;
  rDist[74] = 74.000000;
  rDist[75] = 75.000000;
  rDist[76] = 76.000000;
  rDist[77] = 77.000000;
  rDist[78] = 78.000000;
  rDist[79] = 79.000000;
  rDist[80] = 80.000000;
  rDist[81] = 81.000000;
  rDist[82] = 82.000000;
  rDist[83] = 83.000000;
  rDist[84] = 84.000000;
  rDist[85] = 85.000000;
  rDist[86] = 86.000000;
  rDist[87] = 87.000000;
  rDist[88] = 88.000000;
  rDist[89] = 89.000000;
  rDist[90] = 90.000000;
  rDist[91] = 91.000000;
  rDist[92] = 92.000000;
  rDist[93] = 93.000000;
  rDist[94] = 94.000000;
  rDist[95] = 95.000000;
  rDist[96] = 96.000000;
  rDist[97] = 97.000000;
  rDist[98] = 98.000000;
  rDist[99] = 99.000000;
  rDist[100] = 100.000000;
  rDist[101] = 101.000000;
  rDist[102] = 102.000000;
  rDist[103] = 103.000000;
  rDist[104] = 104.000000;
  rDist[105] = 105.000000;
  rDist[106] = 106.000000;
  rDist[107] = 107.000000;
  rDist[108] = 108.000000;
  rDist[109] = 109.000000;
  rHeight[0] = 40.000000;
  rHeight[1] = 24.000000;
  rHeight[2] = 35.000000;
  rHeight[3] = 38.000000;
  rHeight[4] = 41.000000;
  rHeight[5] = 39.000000;
  rHeight[6] = 41.000000;
  rHeight[7] = 41.000000;
  rHeight[8] = 44.000000;
  rHeight[9] = 35.000000;
  rHeight[10] = 39.000000;
  rHeight[11] = 24.000000;
  rHeight[12] = 26.000000;
  rHeight[13] = 32.000000;
  rHeight[14] = 36.000000;
  rHeight[15] = 43.000000;
  rHeight[16] = 49.000000;
  rHeight[17] = 48.000000;
  rHeight[18] = 48.000000;
  rHeight[19] = 45.000000;
  rHeight[20] = 41.000000;
  rHeight[21] = 35.000000;
  rHeight[22] = 36.000000;
  rHeight[23] = 36.000000;
  rHeight[24] = 42.000000;
  rHeight[25] = 43.000000;
  rHeight[26] = 52.000000;
  rHeight[27] = 55.000000;
  rHeight[28] = 73.000000;
  rHeight[29] = 67.000000;
  rHeight[30] = 68.000000;
  rHeight[31] = 53.000000;
  rHeight[32] = 50.000000;
  rHeight[33] = 14.000000;
  rHeight[34] = 1.000000;
  rHeight[35] = 0.000000;
  rHeight[36] = 0.000000;
  rHeight[37] = 0.000000;
  rHeight[38] = 0.000000;
  rHeight[39] = 0.000000;
  rHeight[40] = 0.000000;
  rHeight[41] = 0.000000;
  rHeight[42] = 0.000000;
  rHeight[43] = 0.000000;
  rHeight[44] = 0.000000;
  rHeight[45] = 0.000000;
  rHeight[46] = 0.000000;
  rHeight[47] = 0.000000;
  rHeight[48] = 0.000000;
  rHeight[49] = 0.000000;
  rHeight[50] = 0.000000;
  rHeight[51] = 0.000000;
  rHeight[52] = 0.000000;
  rHeight[53] = 0.000000;
  rHeight[54] = 0.000000;
  rHeight[55] = 0.000000;
  rHeight[56] = 0.000000;
  rHeight[57] = 0.000000;
  rHeight[58] = 0.000000;
  rHeight[59] = 0.000000;
  rHeight[60] = 0.000000;
  rHeight[61] = 0.000000;
  rHeight[62] = 0.000000;
  rHeight[63] = 0.000000;
  rHeight[64] = 0.000000;
  rHeight[65] = 0.000000;
  rHeight[66] = 0.000000;
  rHeight[67] = 0.000000;
  rHeight[68] = 0.000000;
  rHeight[69] = 0.000000;
  rHeight[70] = 0.000000;
  rHeight[71] = 0.000000;
  rHeight[72] = 0.000000;
  rHeight[73] = 0.000000;
  rHeight[74] = 0.000000;
  rHeight[75] = 0.000000;
  rHeight[76] = 0.000000;
  rHeight[77] = 0.000000;
  rHeight[78] = 45.000000;
  rHeight[79] = 54.000000;
  rHeight[80] = 63.000000;
  rHeight[81] = 79.000000;
  rHeight[82] = 85.000000;
  rHeight[83] = 39.000000;
  rHeight[84] = 21.000000;
  rHeight[85] = 15.000000;
  rHeight[86] = 37.000000;
  rHeight[87] = 42.000000;
  rHeight[88] = 63.000000;
  rHeight[89] = 51.000000;
  rHeight[90] = 35.000000;
  rHeight[91] = 68.000000;
  rHeight[92] = 68.000000;
  rHeight[93] = 53.000000;
  rHeight[94] = 63.000000;
  rHeight[95] = 75.000000;
  rHeight[96] = 92.000000;
  rHeight[97] = 174.000000;
  rHeight[98] = 184.000000;
  rHeight[99] = 145.000000;
  rHeight[100] = 158.000000;
  rHeight[101] = 122.000000;
  rHeight[102] = 129.000000;
  rHeight[103] = 97.000000;
  rHeight[104] = 100.000000;
  rHeight[105] = 91.000000;
  rHeight[106] = 144.000000;
  rHeight[107] = 119.000000;
  rHeight[108] = 154.000000;
  rHeight[109] = 183.000000;
  iZone[0] = 1;
  iZone[1] = 1;
  iZone[2] = 1;
  iZone[3] = 1;
  iZone[4] = 1;
  iZone[5] = 1;
  iZone[6] = 1;
  iZone[7] = 1;
  iZone[8] = 1;
  iZone[9] = 1;
  iZone[10] = 1;
  iZone[11] = 1;
  iZone[12] = 1;
  iZone[13] = 1;
  iZone[14] = 1;
  iZone[15] = 1;
  iZone[16] = 1;
  iZone[17] = 1;
  iZone[18] = 1;
  iZone[19] = 1;
  iZone[20] = 1;
  iZone[21] = 1;
  iZone[22] = 1;
  iZone[23] = 1;
  iZone[24] = 1;
  iZone[25] = 1;
  iZone[26] = 1;
  iZone[27] = 1;
  iZone[28] = 1;
  iZone[29] = 1;
  iZone[30] = 1;
  iZone[31] = 1;
  iZone[32] = 1;
  iZone[33] = 1;
  iZone[34] = 1;
  iZone[35] = 3;
  iZone[36] = 3;
  iZone[37] = 3;
  iZone[38] = 3;
  iZone[39] = 3;
  iZone[40] = 3;
  iZone[41] = 3;
  iZone[42] = 3;
  iZone[43] = 3;
  iZone[44] = 3;
  iZone[45] = 3;
  iZone[46] = 3;
  iZone[47] = 3;
  iZone[48] = 3;
  iZone[49] = 3;
  iZone[50] = 3;
  iZone[51] = 3;
  iZone[52] = 3;
  iZone[53] = 3;
  iZone[54] = 3;
  iZone[55] = 3;
  iZone[56] = 3;
  iZone[57] = 3;
  iZone[58] = 3;
  iZone[59] = 3;
  iZone[60] = 3;
  iZone[61] = 3;
  iZone[62] = 3;
  iZone[63] = 3;
  iZone[64] = 3;
  iZone[65] = 3;
  iZone[66] = 3;
  iZone[67] = 3;
  iZone[68] = 3;
  iZone[69] = 3;
  iZone[70] = 3;
  iZone[71] = 3;
  iZone[72] = 3;
  iZone[73] = 3;
  iZone[74] = 3;
  iZone[75] = 3;
  iZone[76] = 3;
  iZone[77] = 3;
  iZone[78] = 1;
  iZone[79] = 1;
  iZone[80] = 1;
  iZone[81] = 1;
  iZone[82] = 1;
  iZone[83] = 1;
  iZone[84] = 1;
  iZone[85] = 1;
  iZone[86] = 1;
  iZone[87] = 1;
  iZone[88] = 1;
  iZone[89] = 1;
  iZone[90] = 1;
  iZone[91] = 1;
  iZone[92] = 1;
  iZone[93] = 1;
  iZone[94] = 1;
  iZone[95] = 1;
  iZone[96] = 1;
  iZone[97] = 2;
  iZone[98] = 2;
  iZone[99] = 2;
  iZone[100] = 2;
  iZone[101] = 2;
  iZone[102] = 2;
  iZone[103] = 1;
  iZone[104] = 2;
  iZone[105] = 1;
  iZone[106] = 2;
  iZone[107] = 2;
  iZone[108] = 2;
  iZone[109] = 2;
  ff[0] = 0.2000000000000000;
  ff[1] = 0.1000000000000000;
  ff[2] = 0.1500000000000000;
  ff[3] = 0.2250000000000000;
  ff[4] = 0.3375000000000000;
  ff[5] = 0.5062500000000000;
  ff[6] = 0.7593750000000000;
  ff[7] = 1.1390625000000001;
  ff[8] = 1.7085937499999999;
  ff[9] = 2.5628906250000001;
  ff[10] = 3.8443359380000000;
  ff[11] = 5.7665039059999996;
  ff[12] = 8.6497558590000008;
  ff[13] = 12.9746337900000004;
  ff[14] = 19.4619506800000011;
  ff[15] = 29.1929260299999989;
  ff[16] = 43.7893890400000032;
  ff[17] = 50.0000000000000000;
  ff[18] = 0.2000000000000000;
  ff[19] = 0.2000000000000000;
  ff[20] = 0.2000000000000000;
  ff[21] = 0.2000000000000000;
  ff[22] = 0.2000000000000000;
  ff[23] = 0.2000000000000000;
  ff[24] = 0.2000000000000000;
  ff[25] = 0.2000000000000000;
  ff[26] = 0.2000000000000000;
  ff[27] = 0.2000000000000000;
  ff[28] = 0.2000000000000000;
  ff[29] = 0.2000000000000000;
  ff[30] = 0.2000000000000000;
  ff[31] = 0.2000000000000000;
  ff[32] = 0.2000000000000000;
  ff[33] = 0.2000000000000000;
  ff[34] = 0.2000000000000000;
  pp[0] = 0.1000000000000000;
  pp[1] = 0.1000000000000000;
  pp[2] = 0.1000000000000000;
  pp[3] = 0.1000000000000000;
  pp[4] = 0.1000000000000000;
  pp[5] = 0.1000000000000000;
  pp[6] = 0.1000000000000000;
  pp[7] = 0.1000000000000000;
  pp[8] = 0.1000000000000000;
  pp[9] = 0.1000000000000000;
  pp[10] = 0.1000000000000000;
  pp[11] = 0.1000000000000000;
  pp[12] = 0.1000000000000000;
  pp[13] = 0.1000000000000000;
  pp[14] = 0.1000000000000000;
  pp[15] = 0.1000000000000000;
  pp[16] = 0.1000000000000000;
  pp[17] = 0.1000000000000000;
  pp[18] = 1.0000000000000000;
  pp[19] = 4.0000000000000000;
  pp[20] = 7.0000000000000000;
  pp[21] = 10.0000000000000000;
  pp[22] = 13.0000000000000000;
  pp[23] = 16.0000000000000000;
  pp[24] = 19.0000000000000000;
  pp[25] = 22.0000000000000000;
  pp[26] = 25.0000000000000000;
  pp[27] = 28.0000000000000000;
  pp[28] = 31.0000000000000000;
  pp[29] = 34.0000000000000000;
  pp[30] = 37.0000000000000000;
  pp[31] = 40.0000000000000000;
  pp[32] = 43.0000000000000000;
  pp[33] = 46.0000000000000000;
  pp[34] = 49.0000000000000000;
  // Results obtained from the MATLAB implementation of ITU-R P.452-17
  // available on the ITU-R SG3 sharefolder
  double expectedResult[35];
  expectedResult[0] = 137.0340779878329442;
  expectedResult[1] = 135.6994077800590617;
  expectedResult[2] = 139.1402295906403879;
  expectedResult[3] = 135.7553748461061787;
  expectedResult[4] = 130.2255573392716883;
  expectedResult[5] = 125.1203140915127108;
  expectedResult[6] = 129.2381753956295825;
  expectedResult[7] = 133.4109365213244303;
  expectedResult[8] = 137.6350077485726047;
  expectedResult[9] = 141.9418601873207137;
  expectedResult[10] = 146.3826470731874565;
  expectedResult[11] = 151.0333652124861032;
  expectedResult[12] = 156.0476686184496771;
  expectedResult[13] = 161.9480818432638216;
  expectedResult[14] = 175.5751017413251134;
  expectedResult[15] = 181.4116454640673624;
  expectedResult[16] = 195.6900565136127739;
  expectedResult[17] = 221.4087527078947346;
  expectedResult[18] = 144.7198000262729636;
  expectedResult[19] = 146.8225506708625687;
  expectedResult[20] = 149.0696062393699037;
  expectedResult[21] = 150.6136142429844824;
  expectedResult[22] = 151.8213936984992642;
  expectedResult[23] = 152.8307632549825144;
  expectedResult[24] = 153.7092650510293765;
  expectedResult[25] = 154.4953347254533753;
  expectedResult[26] = 155.2131056286021646;
  expectedResult[27] = 155.8788522351968027;
  expectedResult[28] = 156.5041813945726972;
  expectedResult[29] = 157.0977732123853059;
  expectedResult[30] = 157.6664117859054954;
  expectedResult[31] = 158.2156526945842074;
  expectedResult[32] = 158.7503278085816589;
  expectedResult[33] = 159.2751141625971343;
  expectedResult[34] = 159.7963648211887175;
  vector<double> rDisti;
  rDisti.reserve(110);
  vector<double> rHighti;
  rHighti.reserve(110);
  vector<int> iZonei;
  iZonei.reserve(110);
  for (int i = 0; i < 110; i++) {
    rDisti.push_back(rDist[i]);
    rHighti.push_back(rHeight[i]);
    iZonei.push_back(iZone[i]);
  }
  for (int ii = 0; ii < 35; ii++) {
    double result =
        tl_p452(ff[ii], pp[ii], rDisti, rHighti, iZonei, htg, hrg, phi_path, Gt,
                Gr, pol, dct, dcr, DN, N0, press, temp, ha_t, ha_r, dk_t, dk_r);
    EXPECT_DOUBLE_EQ(expectedResult[ii], result);
  }
}
